---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

interface Props {
  title: string;
  date: Date;
  excerpt?: string;
  image?: ImageMetadata;
  category?: string;
  href: string;
  external?: boolean;
}

const { title, date, excerpt, image, category, href, external = false } = Astro.props;
const linkProps = external ? { target: "_blank", rel: "noopener noreferrer" } : {};

const formattedDate = date.toLocaleDateString('de-DE', {
  day: '2-digit',
  month: '2-digit',
  year: 'numeric',
});
---

<a href={href} {...linkProps} class="block group">
  <article class="card bg-base-100 shadow hover:shadow-lg transition-shadow h-full">
    {image && (
      <figure class="overflow-hidden">
        <Image
          src={image}
          alt={title}
          class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"
          loading="lazy"
          width={400}
          height={192}
        />
      </figure>
    )}
    <div class="card-body">
      <div class="flex items-center gap-2 mb-2 flex-wrap">
        {category && (
          <span class="badge badge-primary badge-sm font-sans">{category}</span>
        )}
        <time class="text-xs text-gray-500 font-sans" datetime={date.toISOString()}>
          {formattedDate}
        </time>
        {external && (
          <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
        )}
      </div>
      <h3 class="card-title text-lg text-unionsschwarz group-hover:text-cadenabbia transition-colors">
        {title}
      </h3>
      {excerpt && (
        <p class="text-sm line-clamp-3 text-gray-600">{excerpt}</p>
      )}
    </div>
  </article>
</a>
